<rule_group>
	<group>system</group>
	<group>authentication_failure</group>
	<rule id="1" priority="4">
		<regex>test</regex>
		<description>test rule</description>
	</rule>

	<rule id="2" priority="4">
		<if_trait name="type">syslog</if_trait>
		<if_trait name="syslog_domain">unix_chkpwd</if_trait>
		<description>Grouping of unix_chkpwd logs.</description>
		<group>system</group>
	</rule>


	<rule id="3" priority="5">
		<if_trait name="type">syslog</if_trait>
		<if_trait name="syslog_domain">unix_chkpwd</if_trait>
		<description>Grouping of unix_chkpwd logs.</description>
		<group>system</group>
	</rule>


	<!-- Sep 24 12:10:03 desktopdebian unix_chkpwd[12490]: password check failed for user (christian) -->
	<rule id="4" priority="4">
		<if_rule>3</if_rule>
		<regex>password check failed for user \((\S+)\)$</regex>
		<fields>username</fields>
		<description>sshd: failed user login</description>
		<group>authentication_failure</group>
	</rule>


	<rule id="5" priority="7">
		<if_group>authentication_failure</if_group>
		<if_field name="username" match="exact">root</if_field>
		<description>Failed login into root</description>
	</rule>


	<rule id="6" priority="8">
		<activation_group time="10" rate="5">authentication_failure</activation_group>
		<description>Multiple failed authentications.</description>
	</rule>
	
	<rule id="7" priority="4">
		<if_trait name="type" match="exact">unknown</if_trait>
		<description>Catchall rule for unknown types.</description>
	</rule>

</rule_group>
